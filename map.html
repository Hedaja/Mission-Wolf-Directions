<!DOCTYPE html>
<html>
<head>
 <link rel="stylesheet" href="Leaflet/leaflet.css" />
<meta charset="utf-8"/>
<style>
#mapid { height: 500px; width: 450px;}
</style>
</head>

<body>
<div id="mapid"></div>

 <script src="Leaflet/leaflet.js"></script>
<script src='Leaflet/leaflet-omnivore.min.js'></script>


<script>
var style_short={weight: 6};
var style_long={color: "#FF0000",
				dashArray: 6,
				lineCap: 'butt',
				weight: 3};
var DirectionsPermaLayer =  new L.layerGroup();


function WestcliffeRoute(){
	DirectionsLayerShort = omnivore.gpx('GPX/Westcliffe.gpx');
	DirectionsLayerShort.on('ready', function() {
        	this.setStyle(style_short);
   		 });
	return DirectionsLayer = L.featureGroup([DirectionsLayerShort]);
	};

function BishopsCastelRoute (){
	DirectionsLayerLong =omnivore.gpx('GPX/	BishopsCastle_long.gpx');
		DirectionsLayerLong.on('ready', function() {
        		this.setStyle(style_long);
   			 });
	DirectionsLayerShort = omnivore.gpx('GPX/BishopsCastle.gpx');
	DirectionsLayerShort.on('ready', function() {
        	this.setStyle(style_short);
   		 });
	return DirectionsLayer = L.featureGroup([ DirectionsLayerLong, DirectionsLayerShort]);
		};

   				 
function FortGarlandRoute(){
	DirectionsLayerLong =omnivore.gpx('GPX/	FortGarland_long.gpx');
	DirectionsLayerLong.on('ready', function() {
        	this.setStyle(style_long);
   		 });
	DirectionsLayerShort = omnivore.gpx('GPX/FortGarland.gpx');
	DirectionsLayerShort.on('ready', function() {
        	this.setStyle(style_short);
   		 });
	return DirectionsLayer = L.featureGroup([ DirectionsLayerLong, DirectionsLayerShort]);
	};

function permaRoute(){
	if(typeof DirectionsPermaLayer != "undefined")  {
 	     DirectionsPermaLayer.remove(); 
	};
 	if(DirectionsLayer.hasLayer(DirectionsLayerLong)) {
	 	var permaShort = L.geoJson(DirectionsLayerShort.toGeoJSON()).setStyle(style_short);
		var permaLong = L.geoJson(DirectionsLayerLong.toGeoJSON()).setStyle(style_long);
		return DirectionsPermaLayer =  L.featureGroup([ permaShort, permaLong]).addTo(map);
	} else {
		var permaShort = L.geoJson(DirectionsLayerShort.toGeoJSON()).setStyle(style_short);
		return DirectionsPermaLayer =  L.featureGroup([ permaShort]).addTo(map);
	};
};

var iconWestcliffe = L.icon({
    iconUrl: 'Westcliffe.svg',
    shadowUrl: 'WestcliffeShadow.svg',

    iconSize:     [66, 80], // size of the icon
    shadowSize:   [50, 30], // size of the shadow
    iconAnchor:   [33, 61], // point of the icon which will correspond to marker's location
    shadowAnchor: [14, 25],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
});

var iconFortGarland = L.icon({
    iconUrl: 'FortGarland.svg',
    shadowUrl: 'FortGarlandShadow.svg',

    iconSize:     [50, 60], // size of the icon
    shadowSize:   [50, 20], // size of the shadow
    iconAnchor:   [23, 60], // point of the icon which will correspond to marker's location
    shadowAnchor: [6, 20],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
});

var iconBishopsCastle = L.icon({
    iconUrl: 'BishopsCastle.svg',
    shadowUrl: 'FortGarlandShadow.svg',

    iconSize:     [50, 60], // size of the icon
    shadowSize:   [50, 20], // size of the shadow
    iconAnchor:   [23, 60], // point of the icon which will correspond to marker's location
    shadowAnchor: [6, 20],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
});

var iconLogo = L.icon({
    iconUrl: 'LOGO.png',
    shadowUrl: 'LOGO_shadow.png',

    iconSize:     [55, 70], // size of the icon
    shadowSize:   [45, 25], // size of the shadow
    iconAnchor:   [25, 72], // point of the icon which will correspond to marker's location
    shadowAnchor: [-1, 26],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
});

var map = L.map('mapid').setView([37.85, -105.08], 9);
L.tileLayer( 'http://a.tile.openstreetmap.org/{z}/{x}/{y}.png' , {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'
}).addTo(map);

var MWMarker = L.marker([37.963, -105.215], {icon: iconLogo}).addTo(map);

var WestcliffeMarker = L.marker([38.1359, -105.4638],{icon: iconWestcliffe}).addTo(map);
WestcliffeMarker.on('mouseover', function(e) {
	WestcliffeRoute ();
	DirectionsLayer.addTo(map);
	});
WestcliffeMarker.on('mouseout', function(e) {
	DirectionsLayer.remove()
	});
WestcliffeMarker.on('click', function(e) {
	permaRoute();
});

var BishopsMarker = L.marker([38.0608, -105.0940], {icon: iconBishopsCastle}).addTo(map);
BishopsMarker.on('mouseover', function(e) {
	BishopsCastelRoute();
	DirectionsLayer.addTo(map);
});
BishopsMarker.on('mouseout', function(e) {
	DirectionsLayer.remove()});
BishopsMarker.on('click', function(e) {
	permaRoute();
});


var FortGarlandMarker = L.marker([37.4272, -105.4312], {icon: iconFortGarland}).addTo(map);
FortGarlandMarker.on('mouseover', function(e) {
	FortGarlandRoute();
	DirectionsLayer.addTo(map);
});
FortGarlandMarker.on('mouseout', function(e) {
	DirectionsLayer.remove()
});
FortGarlandMarker.on('click', function(e) {
	permaRoute();
});








/* .on('ready', function() {
        map.fitBounds(directionsLayer.getBounds());
    })
*/
</script>



</body>
</html>


